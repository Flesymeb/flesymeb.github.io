<!doctype html><html lang=zh-cn dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="zh-cn"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>2024 操作系统期末复习 &#183; Hyoung Blog</title><meta name=title content="2024 操作系统期末复习 &#183; Hyoung Blog"><meta name=description content="本文是笔者在同济大学2024年操作系统期末复习的笔记。"><meta name=keywords content="操作系统,复习,"><link rel=canonical href=https://flesymeb.github.io/docs/os/><meta name=author content="Hyoung Yan"><link href=https://github.com/flesymeb/ rel=me><meta property="og:url" content="https://flesymeb.github.io/docs/os/"><meta property="og:site_name" content="Hyoung Blog"><meta property="og:title" content="2024 操作系统期末复习"><meta property="og:description" content="本文是笔者在同济大学2024年操作系统期末复习的笔记。"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2024-12-29T14:03:36+08:00"><meta property="article:modified_time" content="2024-12-29T14:03:36+08:00"><meta property="article:tag" content="操作系统"><meta property="article:tag" content="复习"><meta property="og:image" content="https://flesymeb.github.io/docs/os/featured.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://flesymeb.github.io/docs/os/featured.jpg"><meta name=twitter:title content="2024 操作系统期末复习"><meta name=twitter:description content="本文是笔者在同济大学2024年操作系统期末复习的笔记。"><link type=text/css rel=stylesheet href=/css/main.bundle.min.1aed800aa23824472d900f59919eeb5eb2f44f184953de06a162d6408cb8a9ce6a26a8df63a24ede32fc1b82b06564f82c9df955bf693487033064c41d02b936.css integrity="sha512-Gu2ACqI4JEctkA9ZkZ7rXrL0TxhJU94GoWLWQIy4qc5qJqjfY6JO3jL8G4KwZWT4LJ35Vb9pNIcDMGTEHQK5Ng=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script type=text/javascript src=/js/zen-mode.min.9814dee9614d32aeb56239d118edfe20acd6231424f9b19c2dd48835038414130a5e946c0d1c9087d60e60e31840c9babfd217e3d4b95643dc8d651a71ccdf4a.js integrity="sha512-mBTe6WFNMq61YjnRGO3+IKzWIxQk+bGcLdSINQOEFBMKXpRsDRyQh9YOYOMYQMm6v9IX49S5VkPcjWUacczfSg=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.0e2e7ce1e319db5369cd4badb8265de52c78d08df54617521bdac9c8cd335eea6133a82c83f9cb19baf67b8133335130e7e8ff7cfeaf7171016648dbf5a0578a.js integrity="sha512-Di584eMZ21NpzUutuCZd5Sx40I31RhdSG9rJyM0zXuphM6gsg/nLGbr2e4EzM1Ew5+j/fP6vcXEBZkjb9aBXig==" data-copy=复制 data-copied=已复制></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"文档","name":"2024 操作系统期末复习","headline":"2024 操作系统期末复习","description":"本文是笔者在同济大学2024年操作系统期末复习的笔记。","inLanguage":"zh-cn","url":"https://flesymeb.github.io/docs/os/","author":{"@type":"Person","name":"Hyoung Yan"},"copyrightYear":"2024","dateCreated":"2024-12-29T14:03:36\u002b08:00","datePublished":"2024-12-29T14:03:36\u002b08:00","dateModified":"2024-12-29T14:03:36\u002b08:00","keywords":["操作系统","复习"],"mainEntityOfPage":"true","wordCount":"11799"}]</script><script data-id=umami-script async src=https://flesymeb.github.io/script.js data-website-id=09ad5d18-0c81-4c46-822d-2fc11176000d></script><script type=text/javascript>document.querySelector('script[data-id="umami-script"]').addEventListener("load",function(){const e=document.head.querySelector('meta[property = "og:type"]').getAttribute("content");let t=document.head.querySelector('meta[property = "og:title"]').getAttribute("content"),n=document.head.querySelector('meta[property = "og:url"]').getAttribute("content");umami.track(e+":"+t,{url:n})})</script><script async src=https://cdn.seline.so/seline.js data-token=4bc31d043ab7da0 data-id=seline-script></script><script type=text/javascript>document.querySelector('script[data-id="seline-script"]').addEventListener("load",function(){const e=document.head.querySelector('meta[property = "og:type"]').getAttribute("content");let t=document.head.querySelector('meta[property = "og:title"]').getAttribute("content"),n=document.head.querySelector('meta[property = "og:url"]').getAttribute("content");seline.track("user:"+e+":"+t,{type:e,title:t,url:n})})</script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js></script><script src=https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js></script><script>const firebaseConfig={apiKey:"AIzaSyC2QtnNcwjWp_givX90bPrhi4d1qD7CmNk",authDomain:"yzlevol-blog.firebaseapp.com",projectId:"yzlevol-blog",storageBucket:"yzlevol-blog.appspot.com",messagingSenderId:"470650854099",appId:"1:470650854099:web:da89bf5240e1dee9d7d226",measurementId:"G-W5W0HTZVH2"};var app=firebase.initializeApp(firebaseConfig),db=firebase.firestore(),auth=firebase.auth()</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
跳过正文</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl bg-neutral/25 dark:bg-neutral-800/25"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center w-full gap-2 p-1 pl-0"><a href=/ class="text-base font-medium truncate min-w-0 shrink">Hyoung Blog</a><div class="flex items-center ms-auto"><div class="hidden md:flex"><nav class="flex items-center gap-x-5 h-12"><a href=/docs/ class="flex items-center bf-icon-color-hover" aria-label=文档 title=文档><span class="text-base font-medium break-normal">文档
</span></a><a href=/posts/ class="flex items-center bf-icon-color-hover" aria-label=帖子 title=帖子><span class="text-base font-medium break-normal">帖子
</span></a><a href=/media/ class="flex items-center bf-icon-color-hover" aria-label=影音 title=书影音记录><span class="text-base font-medium break-normal">影音
</span></a><a href=/menav/index.html class="flex items-center bf-icon-color-hover" aria-label=导航 title><span class="text-base font-medium break-normal">导航
</span></a><a href=/archives/ class="flex items-center bf-icon-color-hover" aria-label=时间轴 title="Timeline · Milestone · Record"><span class="text-base font-medium break-normal">时间轴
</span></a><a href=/tags/ class="flex items-center bf-icon-color-hover" aria-label=标签 title=Tags><span class="text-base font-medium break-normal">标签
</span></a><a href=https://github.com/flesymeb/ target=_blank class="flex items-center bf-icon-color-hover" aria-label=github title><span><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><button id=search-button aria-label=Search class="text-base bf-icon-color-hover" title="搜索 (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base bf-icon-color-hover"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav></div><div class="flex md:hidden"><div class="flex items-center h-14 gap-4"><button id=search-button-mobile aria-label=Search class="flex items-center justify-center bf-icon-color-hover" title="搜索 (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile type=button aria-label="Dark mode switcher" class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400"><div class=dark:hidden><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden dark:block"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button>
<input type=checkbox id=mobile-menu-toggle autocomplete=off class="hidden peer">
<label for=mobile-menu-toggle class="flex items-center justify-center cursor-pointer bf-icon-color-hover"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></label><div role=dialog aria-modal=true style=scrollbar-gutter:stable class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
bf-scrollbar"><label for=mobile-menu-toggle class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></label><nav class="mx-auto max-w-md space-y-6"><div class=px-2><a href=/docs/ aria-label=文档 class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=文档 class="text-2xl font-bold tracking-tight">文档</span></a></div><div class=px-2><a href=/posts/ aria-label=帖子 class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=帖子 class="text-2xl font-bold tracking-tight">帖子</span></a></div><div class=px-2><a href=/media/ aria-label=影音 class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=书影音记录 class="text-2xl font-bold tracking-tight">影音</span></a></div><div class=px-2><a href=/menav/index.html aria-label=导航 class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title class="text-2xl font-bold tracking-tight">导航</span></a></div><div class=px-2><a href=/archives/ aria-label=时间轴 class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title="Timeline · Milestone · Record" class="text-2xl font-bold tracking-tight">时间轴</span></a></div><div class=px-2><a href=/tags/ aria-label=标签 class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span title=Tags class="text-2xl font-bold tracking-tight">标签</span></a></div><div class=px-2><a href=https://github.com/flesymeb/ aria-label=github target=_blank class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200"><span class="flex items-center justify-center h-8 w-8 text-2xl"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span><span title class="text-2xl font-bold tracking-tight"></span></a></div></nav></div></div></div></div></div><script>(function(){var t,n,e=document.querySelector(".main-menu");if(!e)return;t=window.location.pathname,n=e.querySelectorAll('a[href="'+t+'"]'),n.forEach(function(e){var t=e.querySelectorAll("span");t.forEach(function(e){e.classList.add("active")})})})()</script></div></div><script type=text/javascript src=/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W+5DcKnbOMMOI+f7IvMGNsVvUfj+ooJ13n6EqqcGEz2FKMVvHLGwWPQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"><img id=background-image src=/docs/os/featured_hu_fa0ab50d44379fe4.jpg role=presentation loading=eager decoding=async fetchpriority=high class="absolute inset-0 w-full h-full object-cover"><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div><script type=text/javascript src=/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W+5DcKnbOMMOI+f7IvMGNsVvUfj+ooJ13n6EqqcGEz2FKMVvHLGwWPQ==" data-blur-id=background-blur data-image-id=background-image data-image-url=/docs/os/featured_hu_fa0ab50d44379fe4.jpg></script><header id=single_header class="mt-5 max-w-prose"><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>.</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/docs/>文档</a><span class="px-1 text-primary-500">/</span></li><li class=hidden><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/docs/os/>2024 操作系统期末复习</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">2024 操作系统期末复习</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-12-29T14:03:36+08:00>2024-12-29</time><span class="px-2 text-primary-500">&#183;</span><span>11799 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>24 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_docs/OS/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span>
</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/flesymeb/flesymebBlog/tree/main/content/docs/OS/index.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title=编辑内容><span class="inline-block align-text-bottom"><span class="relative block icon"><svg height="1em" viewBox="0 0 512 512"><path fill="currentColor" d="M441 58.9 453.1 71c9.4 9.4 9.4 24.6.0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9.0zM209.8 256.2 344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1L186.9 325l16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25 175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 1e2c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l1e2-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7.0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4.0 152V424c0 48.6 39.4 88 88 88H360c48.6.0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1.0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H2e2c13.3.0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg></span></span></a>
</span><span class="px-2 text-primary-500">&#183;</span><span class=mb-[2px]>
<span id=zen-mode-button class="text-lg hover:text-primary-500" title=啟用阅读模式 data-title-i18n-disable=啟用阅读模式 data-title-i18n-enable=停用阅读模式><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 50 50" width="50" height="50"><path fill="currentColor" d="M12.980469 4C9.1204688 4 5.9804688 7.14 5.9804688 11L6 26H9.9804688V11c0-1.65 1.3400002-3 3.0000002-3H40.019531c1.66.0 3 1.35 3 3V39c0 1.65-1.34 3-3 3H29c0 1.54-.579062 2.94-1.539062 4H40.019531c3.86.0 7-3.14 7-7V11c0-3.86-3.14-7-7-7H12.980469zM7 28c-2.206.0-4 1.794-4 4V42c0 2.206 1.794 4 4 4H23c2.206.0 4-1.794 4-4V32c0-2.206-1.794-4-4-4H7zm0 4H23L23.001953 42H7V32z"/></svg></span></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">操作系统
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E5%A4%8D%E4%B9%A0/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">复习</span></span></a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目录</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#本文框架>本文框架</a></li><li><a href=#外设管理>外设管理</a><ul><li><a href=#外设基础概念>外设基础概念</a></li><li><a href=#缓存>缓存</a></li><li><a href=#io-性能优化机械硬盘>IO 性能优化（机械硬盘）</a></li><li><a href=#复习重点>复习重点</a></li></ul></li><li><a href=#进程通信>进程通信</a><ul><li><a href=#互斥同步信号量>互斥、同步、信号量</a></li><li><a href=#经典-ipc-问题-1-interprocess-communication>经典 IPC 问题 1 (InterProcess Communication)</a></li><li><a href=#经典-ipc-问题-2--死锁>经典 IPC 问题 2 & 死锁</a><ul><li><a href=#嗜眠理发师>嗜眠理发师</a></li><li><a href=#死锁>死锁</a></li></ul></li><li><a href=#复习重点-1>复习重点</a></li></ul></li><li><a href=#内存管理>内存管理</a><ul><li><a href=#基本概念>基本概念</a></li><li><a href=#存储管理方式>存储管理方式</a></li><li><a href=#虚拟存储器>虚拟存储器</a></li><li><a href=#复习重点-2>复习重点</a></li></ul></li><li><a href=#文件系统>文件系统</a><ul><li><a href=#unix-文件系统>Unix 文件系统</a></li><li><a href=#文件系统的使用>文件系统的使用</a></li><li><a href=#复习重点-3>复习重点</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目录</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#本文框架>本文框架</a></li><li><a href=#外设管理>外设管理</a><ul><li><a href=#外设基础概念>外设基础概念</a></li><li><a href=#缓存>缓存</a></li><li><a href=#io-性能优化机械硬盘>IO 性能优化（机械硬盘）</a></li><li><a href=#复习重点>复习重点</a></li></ul></li><li><a href=#进程通信>进程通信</a><ul><li><a href=#互斥同步信号量>互斥、同步、信号量</a></li><li><a href=#经典-ipc-问题-1-interprocess-communication>经典 IPC 问题 1 (InterProcess Communication)</a></li><li><a href=#经典-ipc-问题-2--死锁>经典 IPC 问题 2 & 死锁</a><ul><li><a href=#嗜眠理发师>嗜眠理发师</a></li><li><a href=#死锁>死锁</a></li></ul></li><li><a href=#复习重点-1>复习重点</a></li></ul></li><li><a href=#内存管理>内存管理</a><ul><li><a href=#基本概念>基本概念</a></li><li><a href=#存储管理方式>存储管理方式</a></li><li><a href=#虚拟存储器>虚拟存储器</a></li><li><a href=#复习重点-2>复习重点</a></li></ul></li><li><a href=#文件系统>文件系统</a><ul><li><a href=#unix-文件系统>Unix 文件系统</a></li><li><a href=#文件系统的使用>文件系统的使用</a></li><li><a href=#复习重点-3>复习重点</a></li></ul></li></ul></nav></div></details><script>(function(){"use strict";const s=.33,o="#TableOfContents",i=".anchor",a='a[href^="#"]',r="li ul",c="active";let t=!1;function l(e,n){const o=window.scrollY+window.innerHeight*n,i=[...document.querySelectorAll('#TableOfContents a[href^="#"]')],s=new Set(i.map(e=>e.getAttribute("href").substring(1)));if(t)for(let t=0;t<e.length;t++){const n=e[t];if(!s.has(n.id))continue;const o=n.getBoundingClientRect().top+window.scrollY;if(Math.abs(window.scrollY-o)<100)return n.id}for(let t=e.length-1;t>=0;t--){const n=e[t].getBoundingClientRect().top+window.scrollY;if(n<=o&&s.has(e[t].id))return e[t].id}return e.find(e=>s.has(e.id))?.id||""}function e({toc:e,anchors:t,links:n,scrollOffset:s,collapseInactive:o}){const i=l(t,s);if(!i)return;if(n.forEach(e=>{const t=e.getAttribute("href")===`#${i}`;if(e.classList.toggle(c,t),o){const n=e.closest("li")?.querySelector("ul");n&&(n.style.display=t?"":"none")}}),o){const n=e.querySelector(`a[href="#${CSS.escape(i)}"]`);let t=n;for(;t&&t!==e;)t.tagName==="UL"&&(t.style.display=""),t.tagName==="LI"&&t.querySelector("ul")?.style.setProperty("display",""),t=t.parentElement}}function n(){const n=document.querySelector(o);if(!n)return;const l=!1,u=[...document.querySelectorAll(i)],d=[...n.querySelectorAll(a)];l&&n.querySelectorAll(r).forEach(e=>e.style.display="none"),d.forEach(e=>{e.addEventListener("click",()=>{t=!0})});const c={toc:n,anchors:u,links:d,scrollOffset:s,collapseInactive:l};window.addEventListener("scroll",()=>e(c),{passive:!0}),window.addEventListener("hashchange",()=>e(c),{passive:!0}),e(c)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h1 class="relative group">2024 操作系统期末复习<div id=2024-操作系统期末复习 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#2024-%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e6%9c%9f%e6%9c%ab%e5%a4%8d%e4%b9%a0 aria-label=锚点>#</a></span></h1><blockquote><p>Tongji University. 2024/12/28</p><p>Author: Hyoung Yan</p></blockquote><hr><h2 class="relative group">本文框架<div id=本文框架 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e6%9c%ac%e6%96%87%e6%a1%86%e6%9e%b6 aria-label=锚点>#</a></span></h2><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405694119 width=1638 height=831 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405694119_hu_e7417b04261b26cd.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405694119_hu_e7417b04261b26cd.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405694119_hu_3239f7cd1e6cb11c.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405694119.png></figure></p><hr><h2 class="relative group">外设管理<div id=外设管理 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%a4%96%e8%ae%be%e7%ae%a1%e7%90%86 aria-label=锚点>#</a></span></h2><blockquote><p>外设管理，文件管理 Unix V6++源代码不用看。操作流程方面，特别细节的地方不用看。比如，要掌握核心数据结构，磁盘高速缓存池。借助缓存的读写操作，缓存块互斥使用的过程，缓存队列的变化。</p></blockquote><h3 class="relative group">外设基础概念<div id=外设基础概念 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%a4%96%e8%ae%be%e5%9f%ba%e7%a1%80%e6%a6%82%e5%bf%b5 aria-label=锚点>#</a></span></h3><ol><li>CPU 访问内存和访问外设是不一样的<ul><li>内存中的信息每个字节有物理地址。以字节为单位随机访问。访问方式：CPU 将物理地址放在地址总线上，直接访问。</li><li>外设中的信息没有地址，不能直接访问，需要使用特殊的方式（in、out 指令或内存映射），先将外设中的数据取入内存或寄存器，再进行访问。外设中的字节 <strong>不能随机访问</strong><ul><li>键盘、网络输入信息是流式的，读完一个字节才能读下个字节</li><li>硬盘中的信息按扇区组织，扇区 512 字节，全读出来或者被新数据块覆盖。</li></ul></li></ul></li></ol><hr><ol start=2><li>计算机与外设的交互<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735363811364 width=489 height=219 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735363811364.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735363811364.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735363811364.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735363811364.png></figure>外设一次执行一条 IO 命令，完成或失败后，CPU 才能发下条命令。<ul><li>读操作 I：外设转换好的数据放在数据缓存中，供计算机读取</li><li>写操作 O：计算机将数据放在数据缓存中，外设将其中的数据转化成物理信号向外界输出</li></ul></li></ol><hr><ol start=3><li><p>外设控制器的寄存器（端口），以磁盘为例</p><p>CPU 写命令端口向外设发 IO 命令</p><ul><li>读命令 <code>out 0x00000003, comPort</code></li><li>写命令 <code>out 0x00000001, comPort</code></li></ul><p>CPU 读状态端口（in 指令）获取外设状态</p><ul><li>busy 标志为 1，IO 命令执行中，CPU 暂停指令发送，直到 busy 位为 0</li><li>done 标志为 1，IO 命令执行完毕，CPU 可以读取数据</li><li>error 标志为 1，IO 命令执行出错，CPU 可以读取错误信息</li></ul><p>CPU 读数据端口取数据缓存中的数据（外设的输入数据）；写数据端口向数据缓存中写数据（外设的输出数据）</p></li></ol><hr><ol start=4><li><p>三种外设控制方式</p><ul><li>程序直接控制 IO 方式 1（忙等，读）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735364327602 width=918 height=323 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364327602_hu_4ab94b6094aa9820.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364327602_hu_4ab94b6094aa9820.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364327602.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364327602.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735364387680 width=893 height=394 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364387680_hu_3f938f91062e2683.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364387680_hu_3f938f91062e2683.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364387680.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364387680.png></figure><ul><li>CPU 承担全部 IO 事务：忙等外设空闲、IO 完成，计算和 IO 无法并行。</li><li>CPU 只能忙等一个外设，整个系统 IO 效率低下，多个外设无法并行工作。</li></ul></li><li>程序直接控制 IO 方式 2（轮询 polling）
程序在合适的时间点主动查看外设状态（发出请求时，设备忙，离开；IO 未完成，离开），计算和 IO 能够并行，多个外设可以并行，但 CPU 仍然需要承担所有的外设事务。</li><li>中断驱动的 IO 方式<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735364609804 width=911 height=448 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364609804_hu_a8cab3c5c11e80c5.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364609804_hu_a8cab3c5c11e80c5.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364609804.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364609804.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735364868938 width=857 height=430 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364868938_hu_80be50b233ee3c1.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364868938_hu_80be50b233ee3c1.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364868938.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364868938.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735364850659 width=858 height=438 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364850659_hu_c5255b293d1ee00f.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364850659_hu_c5255b293d1ee00f.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364850659.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735364850659.png></figure><ul><li>中断是 IO 完成信号。CPU 无需忙等或轮询 IO 操作。计算和 IO 可以并行。不同的外设，IO 也可以并行。</li><li>数据块从外设数据缓存复制到内存的工作由 CPU 完成。所以，中断驱动的 IO 方式只适合键盘、鼠标等数据缓存很小的外设</li><li>在中断驱动的 I/O 方式中，外设的操作（如数据输入输出）不会像轮询（Polling）那样周期性地检查外设的状态，而是 <strong>由外设主动发出中断信号</strong>，通知操作系统有需要处理的任务。</li></ul></li><li>DMA 方式（磁盘、网络、GPU&mldr;）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735365076544 width=851 height=396 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365076544_hu_5600fa9d4f25f127.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365076544_hu_5600fa9d4f25f127.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365076544.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365076544.png></figure>数据就绪于外设数据缓存后，外设控制器向 DMA 控制器发中断信号 DMA 控制器循环，盗取主存周期，把数据缓存中的数据送入内存，一次传送一个字。这一步会循环直至内存得到数据缓存中的所有数据所有数据传送完毕后，DMA 控制器向 CPU 发中断信号。
<strong>终端处理程序不复制数据，CPU 完全不参与数据传输</strong></li></ul></li></ol><hr><h3 class="relative group">缓存<div id=缓存 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e7%bc%93%e5%ad%98 aria-label=锚点>#</a></span></h3><blockquote><p>只考磁盘的块设备缓存，字符设备不考，把复习题中的状态图看懂，识别出 IO 请求队列，自由缓存队列
磁臂调度算法，磁盘访问时间，计算所在磁道</p></blockquote><ol><li>内存中为每个外设配缓存，暂存外设 IO 数据；缓存在 <strong>核心空间</strong>，Unix v6++中，缓存在内核数据段。</li></ol><hr><ol start=2><li>块设备（存储设备）用于信息存储，例如硬盘、软盘、光盘等，<strong>数据存储以数据块为单位</strong>，缓存是磁盘高速缓存池，可重用的字符块集合。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735365602533 width=919 height=388 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365602533_hu_4ecc4467f5712c0a.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365602533_hu_4ecc4467f5712c0a.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365602533.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365602533.png></figure>UNIX V6++，缓存块 512 字节，同步磁盘上的 1 个扇区。缓存块中存放的那个数据块所有 <strong>进程共享</strong>，<strong>互斥访问</strong>。用前上锁，用后解锁。</li></ol><hr><ol start=3><li>借助缓存的读写操作<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735365703626 width=870 height=402 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365703626_hu_d1014cd3e2e60a9d.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365703626_hu_d1014cd3e2e60a9d.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365703626.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365703626.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735365747295 width=900 height=424 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365747295_hu_7f83cd4b53f7a399.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365747295_hu_7f83cd4b53f7a399.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365747295.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365747295.png></figure><ul><li>写入数据量不足一个数据块，先读后写 <code>buffer[offset] = a</code></li><li>写入一整块，无需先读 <code>buffer = 数组a</code></li><li>内核会在合适时机，将缓存中的数据块写回磁盘（持久化操作）；什么时候？最晚，关机时，需要把新数据写回磁盘。装新数据的是 <strong>脏缓存块</strong>。写回磁盘前，如果断电，磁盘会丢数据。</li></ul></li></ol><hr><ol start=4><li>性能分析<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735365934836 width=896 height=383 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365934836_hu_27e6c5cabc46a089.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365934836_hu_27e6c5cabc46a089.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365934836.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365934836.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735365940729 width=913 height=374 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365940729_hu_eebb2a3241cc8864.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365940729_hu_eebb2a3241cc8864.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365940729.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735365940729.png></figure></li></ol><hr><ol start=5><li>用户空间 IO 的使用场合<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735366017740 width=906 height=388 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366017740_hu_dc4fd65c2ad99ae4.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366017740_hu_dc4fd65c2ad99ae4.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366017740.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366017740.png></figure></li></ol><hr><ol start=6><li><p>Unix V6++的磁盘高速缓冲池</p><p><strong>缓存控制块</strong>：m_Buf [i] 是 Buffer [i] 的控制块</p><ul><li><code>b_dev</code>：磁盘号</li><li><code>b_blkno</code>：扇区号</li><li><code>b_wcount</code>：IO 参数，传送字节数</li><li><code>b_addr</code>：缓存块首地址</li><li><code>b_flags</code>：缓存块状态</li><li><code>b_error</code>：错误码</li><li><code>b_resid</code>：IO 错误时剩余字节数<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735366156580 width=931 height=505 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366156580_hu_98cca6f7d39b896d.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366156580_hu_98cca6f7d39b896d.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366156580.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366156580.png></figure></li></ul><p><strong>缓存管理</strong>：进程 <strong>随机读写</strong> 缓存池中的数据（任意数据块，从任意偏移量开始的任意字节）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735366425169 width=771 height=263 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366425169.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366425169.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366425169.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366425169.png></figure></p><ul><li>新请求放队尾，前一个 IO 请求完成的时候启动下一个 IO 请求</li><li>如果仅考虑读操作，IO 子系统 FIFS 地为系统提供缓存不命中的数据块。</li><li><strong>读是同步请求</strong>，影响 IO 系统响应速度，优先级高。</li><li>脏缓存块需要写回磁盘，防止数据丢失。<strong>写操作是异步的，优先级低</strong>。</li><li>Unix V6 写操作执行时机：<ul><li>脏缓存块分配用来装新数据块时写回磁盘。</li><li>每 30s 执行一次 update 程序，将所有脏缓存块写回磁盘。</li></ul></li></ul></li></ol><hr><ol start=7><li>LRU 的自由缓存队列<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735366611883 width=844 height=362 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366611883_hu_4350003ab75373a4.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366611883_hu_4350003ab75373a4.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366611883.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366611883.png></figure></li></ol><hr><ol start=8><li>Unix 的外设和缓存管理
所有磁盘共用磁盘高速缓冲池，每张磁盘有自己私有的设备缓存队列和 IO 请求队列。</li></ol><hr><ol start=9><li><p>外设管理和块设备管理<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735366850705 width=914 height=431 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366850705_hu_ec2fcf313394e355.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366850705_hu_ec2fcf313394e355.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366850705.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366850705.png></figure></p><ul><li>块设备开关表 bdevsw 管理所有块设备，每一个元素管理一种块设备</li><li>字符设备开关表 cdevsw 管理所有终端。每个元素管理一种终端</li></ul><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735366858002 width=894 height=426 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366858002_hu_b36adf1820d7a5e0.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366858002_hu_b36adf1820d7a5e0.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366858002.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735366858002.png></figure></p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>BlockDevice</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 设备驱动
</span></span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>int</span> <span class=n>Open</span><span class=p>(</span><span class=kt>short</span> <span class=n>dev</span><span class=p>,</span> <span class=kt>int</span> <span class=n>mode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>int</span> <span class=nf>Close</span><span class=p>(</span><span class=kt>short</span> <span class=n>dev</span><span class=p>,</span> <span class=kt>int</span> <span class=n>mode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>int</span> <span class=nf>Strategy</span><span class=p>(</span><span class=n>Buf</span><span class=o>*</span> <span class=n>bp</span><span class=p>);</span> <span class=c1>// 执行IO操作
</span></span></span><span class=line><span class=cl>    <span class=k>virtual</span> <span class=kt>void</span> <span class=nf>Start</span><span class=p>();</span> <span class=c1>// 向磁盘发IO命令
</span></span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span><span class=c1>// n，同类磁盘的数量
</span></span></span><span class=line><span class=cl>    <span class=n>Devtab</span><span class=o>*</span> <span class=n>d_tab</span><span class=p>[</span><span class=n>n</span><span class=p>];</span> <span class=c1>// 块设备表
</span></span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></div></div><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>Devtab</span> <span class=c1>// 块设备表
</span></span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d_active</span><span class=p>;</span><span class=c1>// 磁盘忙，IO请求队列非空
</span></span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d_errcnt</span><span class=p>;</span><span class=c1>// 队首IO操作，出错次数
</span></span></span><span class=line><span class=cl>    <span class=n>Buf</span><span class=o>*</span> <span class=n>b_forw</span><span class=p>;</span> <span class=c1>// 设备缓存队列队首
</span></span></span><span class=line><span class=cl>    <span class=n>Buf</span><span class=o>*</span> <span class=n>b_back</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Buf</span><span class=o>*</span> <span class=n>d_actf</span><span class=p>;</span> <span class=c1>// IO请求队列队首
</span></span></span><span class=line><span class=cl>    <span class=n>Buf</span><span class=o>*</span> <span class=n>d_actl</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></div></div><p>主硬盘。设备号 0，0。 管理硬盘的内核对象：g_ATADevice<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735367290981 width=923 height=413 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367290981_hu_b45648b7da717cd4.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367290981_hu_b45648b7da717cd4.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367290981.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367290981.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735367431351 width=910 height=395 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367431351_hu_b0299a6fd7b96501.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367431351_hu_b0299a6fd7b96501.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367431351.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367431351.png></figure></p></li></ol><hr><ol start=10><li><p>ATA 硬盘驱动程序</p><ol><li><p>编程 DMA 控制器：设置内存物理地址，数据传输量</p><p>写 PRD 表。PRD 表，最多 10 项。每一项是一个 PRD（Physical Region Descriptor，物理内存区描述符），管理 DMA 操作访问的一块连续内存区域。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735367779522 width=874 height=362 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367779522_hu_8da65c37364e4e15.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367779522_hu_8da65c37364e4e15.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367779522.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367779522.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735367791973 width=771 height=424 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367791973.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367791973.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367791973.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367791973.png></figure></p></li><li><p>编程磁盘控制器：设置需要 IO 的磁盘扇区号，扇区数<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735367849904 width=879 height=311 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367849904_hu_7edf017d84ce7571.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367849904_hu_7edf017d84ce7571.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367849904.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735367849904.png></figure></p><ul><li>字节分解：bp-> b_blkno 是一个 32 位的整数，需要拆解为 4 个字节。每个字节包含 8 位，因此通过移位操作可以提取每个字节的具体值。</li><li>控制端口：IOPort:: OutByte 函数每次只能发送一个字节（8 位数据）。为了将 32 位的数据分解为多个字节，并通过多个端口传输，需要使用移位操作获取每个字节。</li></ul></li><li><p>向磁盘控制器和 DMA 控制器发 IO 命令<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735368096651 width=771 height=379 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368096651.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368096651.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368096651.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368096651.png></figure></p></li><li><p>磁盘中断处理程序 <code>ATADriver::ATAHandler</code><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735368275073 width=934 height=870 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368275073_hu_ec892255964dc3c9.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368275073_hu_ec892255964dc3c9.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368275073.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368275073.png></figure></p></li></ol></li></ol><hr><ol start=11><li><p>同步读<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735368416458 width=862 height=432 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368416458_hu_41c4885701d7c88b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368416458_hu_41c4885701d7c88b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368416458.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368416458.png></figure></p><ul><li><code>bp = Getblk(dev,blkno)</code> 申请使用缓存池中的数据块</li><li><code>Brelse(Buf* bp)</code> 释放数据块的使用权</li></ul></li></ol><hr><ol start=12><li><p>异步写</p><p>数据写入缓存池后，解锁缓存块，写操作完毕。数据块可供其它进程使用。需要注意的技术细节：</p><ul><li>如果写入磁盘数据块的数据量不足 512 字节。先读后写，保护磁盘数据块中新数据覆盖不到的旧数据。</li><li>数据块写满时刷回磁盘。这是假定进程会顺序写磁盘数据，数据块写至底部不再有重用价值，异步写回磁盘。<ul><li>若写不满，打脏标识、解锁缓存块，写操作完毕。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735368722765 width=920 height=494 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368722765_hu_35fd9420055c9a41.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368722765_hu_35fd9420055c9a41.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368722765.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368722765.png></figure></li></ul></li></ul><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735368801485 width=898 height=412 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368801485_hu_ebb293cc17bdba04.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368801485_hu_ebb293cc17bdba04.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368801485.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368801485.png></figure></p></li></ol><hr><ol start=13><li>总结 Unix V6++外设管理模块和缓存管理模块<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735368921867 width=873 height=445 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368921867_hu_db6586be163cc28b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368921867_hu_db6586be163cc28b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368921867.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735368921867.png></figure></li></ol><hr><h3 class="relative group">IO 性能优化（机械硬盘）<div id=io-性能优化机械硬盘 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#io-%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e6%9c%ba%e6%a2%b0%e7%a1%ac%e7%9b%98 aria-label=锚点>#</a></span></h3><ol><li><p><strong>机械硬盘（等速圆周运转的设备）</strong></p><ul><li>每个盘面上有许多同心磁道，用于存储信息，从外至内编号为 0，1，2，3 等。</li><li>所有盘面上 <strong>相同编号的磁道组成一个柱面</strong>，<strong>柱面号即为磁道号</strong>。</li><li>每个磁道被划分为多个等圆心角的圆弧，每个圆弧为一个 <strong>扇区</strong>，编号为 0，1，2，3 等。</li><li>每个磁盘有上下两个盘面，每个盘面配有一个读写磁头，<strong>磁头号</strong>，磁头编号为 0，1，2，3 等。</li></ul><p>磁盘的信息存储和访问单位为 <strong>扇区</strong>，目前的技术标准是每个扇区存放 512 字节。扇区的物理地址由柱面号、磁头号和扇区号组成。通过序列化可以得到扇区的逻辑地址。</p></li></ol><hr><ol start=2><li><p>硬盘访问耗时：从 CPU 写命令寄存器至 → 数据块（512 字节）进硬盘控制器数据缓存</p><ul><li><strong>寻道时间（seek time）</strong>：磁头从当前柱面移动到目标柱面的时间。平均寻道时间小于 10ms。</li><li><strong>旋转延时（Rotational delay）</strong>：磁头到达目标柱面（磁道）后，等待欲访问扇区转到磁头之下。平均旋转延时为磁盘旋转一周所需时间 T 的 1/2。</li><li><strong>数据传输时间（Data transfer）</strong>：磁头走过目标扇区，期间读扇区内容至硬盘数据缓存。若每个磁道包含 N 个扇区。数据传输时间为：<code>T/N</code>。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735369462773 width=415 height=175 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369462773.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369462773.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369462773.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369462773.png></figure></li></ul></li></ol><hr><ol start=3><li><p>磁盘 IO 性能优化</p><ol><li><p>磁臂调度算法优化寻道时间<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735369665159 width=670 height=108 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369665159.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369665159.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369665159.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369665159.png></figure></p><ul><li><p>FIFO（FIFS）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735369698002 width=596 height=131 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369698002.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369698002.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369698002.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369698002.png></figure></p></li><li><p>SSTF（Shortest Service Time First）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735369754020 width=673 height=151 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369754020.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369754020.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369754020.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369754020.png></figure></p></li><li><p>SCAN（电梯调度算法）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735369762887 width=733 height=171 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369762887.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369762887.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369762887.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369762887.png></figure></p><p><strong>算法性能比较</strong></p><ul><li>SSTF 性能较好，但可能出现 <strong>被饿死的 IO 请求</strong>。</li><li>SCAN 和 C-SCAN 理论上不会饿死 IO 请求，但是会出现“磁臂粘着”（Arm stickiness）现象。指：一个或几个进程对某个柱面密集访问，反复读写其中的磁道，导致磁臂停留此处不动，其余进程针对其它柱面的 IO 请求会长期得不到处理。</li><li>解决方法：设置多个磁盘 IO 请求集合<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735369935908 width=843 height=390 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369935908_hu_46ce3af50030b76c.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369935908_hu_46ce3af50030b76c.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369935908.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735369935908.png></figure></li></ul></li></ul></li><li><p>优化旋转延迟（硬件）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735370167905 width=912 height=403 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735370167905_hu_c7823936b35b2620.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735370167905_hu_c7823936b35b2620.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735370167905.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735370167905.png></figure></p></li><li><p>考虑数据定位开销，优化文件访问速度：文件在磁盘上尽量连续存放。swap 分区上的进程图像一定要连续存放。</p></li><li><p>预读技术<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735370594107 width=745 height=463 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735370594107.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735370594107.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735370594107.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735370594107.png></figure></p></li></ol></li></ol><hr><h3 class="relative group">复习重点<div id=复习重点 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%a4%8d%e4%b9%a0%e9%87%8d%e7%82%b9 aria-label=锚点>#</a></span></h3><ol><li>说明操作系统进程设备管理的初衷？
因为很麻烦，所以访问外设特别慢。计算机系统在设计时需要有效解决 <strong>CPU 访问内存和外设信息不一致的问题</strong>，提高系统的整体性能和响应速度。</li></ol><hr><ol start=2><li>设备管理中，I/O 软件的组成？什么是设备驱动程序？其主要完成什么功能？介绍 I/O 管理的流程。</li></ol><hr><ol start=3><li>I/O 硬件技术中，数据传输技术有那些？分别介绍？并说明中断技术和 DMA 技术的区别与联系？</li></ol><hr><h2 class="relative group">进程通信<div id=进程通信 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e8%bf%9b%e7%a8%8b%e9%80%9a%e4%bf%a1 aria-label=锚点>#</a></span></h2><blockquote><p>（1）读者、写者公平的解，不要求掌握
（2）复习资料里，明确写明不要求掌握的，考前肯定不需要看。
（3）银行家算法，资源释放算法不要求能够写出来。
银行家算法，Dijstra 1965 年提出。
算法的缺点（1）每次资源分配时实施，比较耗时（2）保守。进程提出的资源需求量很可能大于需要量。并且算法假定任何进程均可能随时提出资源申请（3）必需事先知道每个进程的最大资源需求量，工程上很难办到，所以这是一个理论上的算法。
数据库系统写操作日志、不预防死锁。
发现死锁之后（1）重启（2）恢复最近检查点，回放其后所有日志。
嗜眠理发师，PPT part 5 进程通信 2 个<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735391773078 width=1600 height=900 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735391773078_hu_b83e68d057d45f4f.jpg srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735391773078_hu_b83e68d057d45f4f.jpg 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735391773078_hu_61a2e10d6c1d229c.jpg 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735391773078.jpg></figure>银行家算法是死锁避免算法
预读不考</p></blockquote><hr><ol><li><p>可执行存储器是用来存放进程图像的存储单元，包括 <strong>内存</strong> 和 <strong>盘交换区</strong>。</p><ul><li>内存中的进程图像可以执行，因为每个单元都有物理地址</li><li>盘交换区中的图像不可执行，运行前必须要为其分配内存</li><li>内存中的进程 SLOAD = 1，盘交换区中的进程 SLOAD = 0</li></ul></li><li><p>可执行存储器的使用状态</p><ul><li>可执行存储器的使用状态 RunIn，内存无法容纳，RunOut，内存可以容纳</li><li>进程在内存或盘交换区的驻留时长 Process 结构中设置 p_time 字段</li><li>设置 0#进程负责进程换入任务</li></ul></li></ol><hr><h3 class="relative group">互斥、同步、信号量<div id=互斥同步信号量 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e4%ba%92%e6%96%a5%e5%90%8c%e6%ad%a5%e4%bf%a1%e5%8f%b7%e9%87%8f aria-label=锚点>#</a></span></h3><ol><li><p>并发访问时，共享变量的值为什么会出错?(单核)</p><p>现运行的应用程序 PA 执行完每条指令后，可能因为响应中断放弃 CPU。</p><ul><li>下台时，保存所有用户态寄存器。</li><li>被调度、再次运行时，恢复上次保存的用户态寄存器。</li><li>若某寄存器存有共享变量的更新，放弃 CPU 时，其它进程看不到更新，会读到过时的旧值。再者，若放弃 CPU 时段，其它进程 PB 有更新该变量，待 PA 再次上台，恢复寄存器时会覆盖 PB 对共享变量的更新。变量的值就会出错。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735393085057 width=723 height=188 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393085057.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393085057.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393085057.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393085057.png></figure></li></ul></li></ol><hr><ol start=2><li><p>怎样保证共享变量的值不出错？</p><ul><li>上锁，保证更新共享变量是 <strong>原子操作</strong>。上例：counter++，一次完成。</li><li><strong>并发进程互斥访问共享变量</strong>。用前上锁，用后解锁。访问期间，禁止其它进程的并发访问请求。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735393202573 width=836 height=368 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393202573_hu_5b4925d482d51aeb.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393202573_hu_5b4925d482d51aeb.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393202573.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393202573.png></figure></li></ul></li></ol><hr><ol start=3><li><p>互斥、临界资源、临界区</p><ul><li>互斥：一次只允许一个进程使用。</li><li>需要互斥保护的叫做临界资源，包括 共享变量（数据结构）和计算机系统中所有的外部设备。</li><li>临界区是访问共享变量的那段代码。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735393261330 width=829 height=235 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393261330_hu_38bbcc28b0e69f96.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393261330_hu_38bbcc28b0e69f96.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393261330.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393261330.png></figure></li></ul></li></ol><hr><ol start=3><li><p>锁的实现</p><p>互斥机制应遵循的原则（假设，进程 PA 需要访问共享资源 R）</p><ul><li>空闲让进：R 空闲，可以使用</li><li>忙则等待：R 有进程用，等</li><li>有限等待：不可以等太久</li><li>让权等待：若要等待，入睡放弃 CPU</li><li>（睡眠锁，适用于临界区很长或临界区内进程有可能入睡的情况）</li></ul><ol><li><p>软件实现的锁<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735393390097 width=916 height=346 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393390097_hu_3cb4a6e986089f01.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393390097_hu_3cb4a6e986089f01.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393390097.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393390097.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735393511298 width=881 height=428 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393511298_hu_4fb1099aee0e0df0.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393511298_hu_4fb1099aee0e0df0.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393511298.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393511298.png></figure></p></li><li><p>关中断</p><ul><li>没有中断，就没有调度。</li><li>内核可以用关中断的方法实现原子操作。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735393627111 width=354 height=165 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393627111.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393627111.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393627111.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393627111.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735393644054 width=809 height=383 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393644054_hu_b3634d1a4dae1b8f.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393644054_hu_b3634d1a4dae1b8f.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393644054.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393644054.png></figure></li></ul></li><li><p>应用程序可以使用的锁（硬件）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735393840177 width=852 height=356 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393840177_hu_1bbd1dfbacac2f83.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393840177_hu_1bbd1dfbacac2f83.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393840177.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735393840177.png></figure></p></li></ol></li></ol><hr><ol start=4><li><p>信号量 semaphore</p><blockquote><p>现代操作系统为应用程序提供的同步和互斥工具</p></blockquote><p><strong>信号量的用法：</strong></p><ul><li>为共享资源 <code>R</code> 配一个信号量，用来描述资源使用状态 <code>semaphore semphoreR</code>;</li><li>进程访问共享资源前，执行 <code>P</code> 操作，同步等待资源访问权限。</li><li>访问结束后，执行 <code>V</code> 操作，释放资源访问权限、唤醒等待使用资源的另一个进程<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735394259012 width=906 height=396 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735394259012_hu_137af289703caa9.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735394259012_hu_137af289703caa9.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735394259012.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735394259012.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735394379348 width=653 height=388 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735394379348.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735394379348.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735394379348.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735394379348.png></figure></li></ul></li></ol><hr><ol start=5><li><p>用信号量实现的互斥锁</p><ul><li>互斥信号量初值为 1，又叫 <strong>互斥锁</strong>。</li></ul><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span> <span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>semaphore</span> <span class=n>mutex</span> <span class=err>；</span> <span class=c1>//保护共享变量 count
</span></span></span><span class=line><span class=cl><span class=n>mutex</span><span class=p>.</span><span class=n>value</span> <span class=o>=</span> <span class=mi>1</span> <span class=p>;</span></span></span></code></pre></div></div></li></ol><hr><ol start=6><li><p>同步
同步表现为并发系统中，经常需要：</p><ul><li>观察系统状态，确定自己是不是可以继续前进</li><li>修正系统状态，维护系统咋混给他一致性
实施同步的位置叫做 <strong>同步点</strong></li></ul><p><strong>用信号量实施同步</strong>：设置同步信号量，维护系统状态，在同步点上：</p><ul><li>进程检测、更新系统状态，识别共享资源使用状态，必要时入睡、同步等待访问权限。<strong>核心是原子操作 P</strong>。</li><li>资源访问结束后，进程修正系统状态，释放资源访问权限、唤醒等待使用资源的其它进程。<strong>核心是原子操作 V。</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735395021391 width=1600 height=900 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395021391_hu_91867f8bc7a7d89e.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395021391_hu_91867f8bc7a7d89e.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395021391_hu_44eb1a4f0267e4d.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395021391.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735395280832 width=923 height=418 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395280832_hu_d8aff492fd5cfdb2.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395280832_hu_d8aff492fd5cfdb2.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395280832.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395280832.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735395271641 width=1600 height=900 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395271641_hu_e5f3b8ff365eea20.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395271641_hu_e5f3b8ff365eea20.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395271641_hu_80a36c81c1e6d0a1.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395271641.png></figure></li></ul></li></ol><hr><h3 class="relative group">经典 IPC 问题 1 (InterProcess Communication)<div id=经典-ipc-问题-1-interprocess-communication class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e7%bb%8f%e5%85%b8-ipc-%e9%97%ae%e9%a2%98-1-interprocess-communication aria-label=锚点>#</a></span></h3><ol><li>引例一：吃水果<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735395820176 width=598 height=315 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395820176.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395820176.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395820176.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395820176.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735395878018 width=833 height=333 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395878018_hu_da5ace3f737da487.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395878018_hu_da5ace3f737da487.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395878018.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395878018.png></figure></li></ol><hr><ol start=2><li>引例二：消息队列（多客户机、单服务器、无界缓存）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735395944519 width=877 height=410 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395944519_hu_3e2eb43dec44ecc6.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395944519_hu_3e2eb43dec44ecc6.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395944519.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395944519.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735395952866 width=894 height=425 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395952866_hu_de86af594f9ce8a6.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395952866_hu_de86af594f9ce8a6.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395952866.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735395952866.png></figure></li></ol><hr><ol start=3><li><p>生产者、消费者问题<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735401029098 width=897 height=422 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401029098_hu_18fd594b5f21adec.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401029098_hu_18fd594b5f21adec.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401029098.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401029098.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735401070041 width=844 height=468 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401070041_hu_e6fa7e00a38d5fe3.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401070041_hu_e6fa7e00a38d5fe3.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401070041.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401070041.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735401345151 width=888 height=448 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401345151_hu_4396bb9ec7b32ca6.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401345151_hu_4396bb9ec7b32ca6.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401345151.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401345151.png></figure><strong>死锁</strong>：并发系统中，因资源管理不当导致的进程彼此等待，均无法前进的现象。</p><p><strong>产生死锁的情形</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735401501813 width=910 height=425 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401501813_hu_ecf549992f2f34d3.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401501813_hu_ecf549992f2f34d3.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401501813.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401501813.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735401596417 width=909 height=440 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401596417_hu_3bb1a918390483bf.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401596417_hu_3bb1a918390483bf.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401596417.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735401596417.png></figure></p></li></ol><hr><ol start=4><li><p>读者/写者问题</p><ul><li>共享变量需要互斥访问，但是读操作是可以并发的，允许读操作并发可以提高并发系统的效率。</li><li>读操作，不会改变共享变量的值</li><li>写操作，改变共享变量的值，两种写操作：<strong>更新</strong> 和 <strong>赋值</strong></li></ul><ol><li><p>状态分析</p><ul><li>写操作必须互斥，不能与其他操作并发， 用一个互斥信号量就能搞定</li><li>读操作可以和读操作并发，不能与写操作并发，实现上，我们需要一个读者计数器<ul><li>读者数量非 0 时，新的读操作可以并发，否则必需与写操作互斥</li><li>细节：读者计数器是一个共享变量，需要一个互斥信号量予以保护</li></ul></li></ul></li><li><p>读者有优先权的解决方案</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735402471246 width=853 height=423 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402471246_hu_ab605e0562b622a9.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402471246_hu_ab605e0562b622a9.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402471246.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402471246.png></figure>存在的问题：饿死写进程<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735402539808 width=908 height=420 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402539808_hu_687cb49a9a79c96e.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402539808_hu_687cb49a9a79c96e.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402539808.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402539808.png></figure></p></li><li><p>写进程优先的解决方案<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735402695263 width=907 height=391 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402695263_hu_838fb5c0de78f92b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402695263_hu_838fb5c0de78f92b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402695263.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735402695263.png></figure></p></li><li><p>例子<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735403084436 width=818 height=383 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403084436_hu_c4684630aadda05e.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403084436_hu_c4684630aadda05e.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403084436.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403084436.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735403091964 width=705 height=363 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403091964.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403091964.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403091964.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403091964.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735403101069 width=871 height=448 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403101069_hu_ed206d917df0b6fc.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403101069_hu_ed206d917df0b6fc.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403101069.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403101069.png></figure></p></li></ol></li></ol><hr><h3 class="relative group">经典 IPC 问题 2 & 死锁<div id=经典-ipc-问题-2--死锁 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e7%bb%8f%e5%85%b8-ipc-%e9%97%ae%e9%a2%98-2--%e6%ad%bb%e9%94%81 aria-label=锚点>#</a></span></h3><h4 class="relative group">嗜眠理发师<div id=嗜眠理发师 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%97%9c%e7%9c%a0%e7%90%86%e5%8f%91%e5%b8%88 aria-label=锚点>#</a></span></h4><ul><li>信号量的局限性，快餐店问题</li><li>嗜眠理发师问题</li></ul><ol><li><p>信号量的局限性<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735403336955 width=742 height=316 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403336955.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403336955.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403336955.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403336955.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735403344759 width=801 height=408 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403344759_hu_c40037c341520336.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403344759_hu_c40037c341520336.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403344759.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403344759.png></figure>原始设计问题 <code>seat</code> 信号量的值表示空座位的数量，消费者每次进入时都会调用 <code>p(seat)</code>，如果座位满了（信号量为 0），进程会被阻塞。然后，进程执行完 <code>eating</code> 后释放信号量（<code>v(seat)</code>）。</p><p>问题：</p><ol><li><p>信号量的值反映的是空座位数，而信号量本身并没有明确控制座位的数量，而只是作为一个计数信号量来管理等待队列。信号量的计数只适用于“占用资源”或“允许访问资源”，但它不能存储座位数。</p></li><li><p>没有互斥机制：多个消费者进程可能会在“取座位”和“释放座位”这两个操作之间发生竞态条件。假设两个顾客同时到达并试图访问座位时，他们可能同时看到座位满了（<code>seat == 0）</code>，但这时两者的 seat 数可能已经被错误地更新或冲突，从而导致座位的数量被错误管理。</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl>   <span class=n>semaphore</span> <span class=n>mutex</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>  <span class=c1>// 用于保护共享资源seat的互斥
</span></span></span><span class=line><span class=cl>   <span class=kt>int</span> <span class=n>seat</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span>  <span class=c1>// 座位数量
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>customer进程</span><span class=err>：</span>
</span></span><span class=line><span class=cl>   <span class=n>p</span><span class=p>(</span><span class=n>mutex</span><span class=p>);</span>  <span class=c1>// 获取锁
</span></span></span><span class=line><span class=cl>   <span class=k>if</span> <span class=p>(</span><span class=n>seat</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>  <span class=c1>// 如果没有空座位
</span></span></span><span class=line><span class=cl>   <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>v</span><span class=p>(</span><span class=n>mutex</span><span class=p>);</span>  <span class=c1>// 释放锁
</span></span></span><span class=line><span class=cl>      <span class=k>goto</span> <span class=n>out</span><span class=p>;</span>  <span class=c1>// 跳转到退出
</span></span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>seat</span><span class=o>--</span><span class=p>;</span>  <span class=c1>// 减少空座位数量
</span></span></span><span class=line><span class=cl>      <span class=n>v</span><span class=p>(</span><span class=n>mutex</span><span class=p>);</span>  <span class=c1>// 释放锁
</span></span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>eating</span><span class=p>;</span>  <span class=c1>// 顾客吃饭
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=n>p</span><span class=p>(</span><span class=n>mutex</span><span class=p>);</span>  <span class=c1>// 重新获取锁
</span></span></span><span class=line><span class=cl>   <span class=n>seat</span><span class=o>++</span><span class=p>;</span>  <span class=c1>// 增加空座位数量
</span></span></span><span class=line><span class=cl>   <span class=n>v</span><span class=p>(</span><span class=n>mutex</span><span class=p>);</span>  <span class=c1>// 释放锁
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nl>out</span><span class=p>:</span>
</span></span><span class=line><span class=cl>   <span class=n>exit</span><span class=p>;</span>  <span class=c1>// 退出
</span></span></span></code></pre></div></div></li></ol></li><li><p>理发店<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735403684559 width=877 height=394 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403684559_hu_5de1018e2f916d8b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403684559_hu_5de1018e2f916d8b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403684559.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735403684559.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735404137584 width=900 height=448 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404137584_hu_399dc32b9b2df619.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404137584_hu_399dc32b9b2df619.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404137584.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404137584.png></figure></p></li></ol><hr><ol start=3><li>失眠理发师<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735404458050 width=898 height=312 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404458050_hu_4359d4b738045b02.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404458050_hu_4359d4b738045b02.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404458050.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404458050.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735404469821 width=826 height=365 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404469821_hu_1d37d8421f91a824.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404469821_hu_1d37d8421f91a824.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404469821.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404469821.png></figure></li></ol><hr><h4 class="relative group">死锁<div id=死锁 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e6%ad%bb%e9%94%81 aria-label=锚点>#</a></span></h4><ul><li>在一个进程集合中, 每个进程都因等待永远不会发生的事件而阻塞，称这种系统状态为死锁。</li><li>死锁产生的原因：资源竞争，资源分配策略导致进程推进顺序不当。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735404711348 width=756 height=128 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404711348.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404711348.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404711348.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404711348.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735404865127 width=731 height=377 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404865127.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404865127.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404865127.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404865127.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735404875366 width=748 height=264 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404875366.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404875366.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404875366.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404875366.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735404945865 width=796 height=364 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404945865.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404945865.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404945865.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404945865.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735404954667 width=801 height=424 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404954667_hu_858632c9884b13af.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404954667_hu_858632c9884b13af.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404954667.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735404954667.png></figure></li></ul><hr><ol><li>死锁的必要条件<ul><li>系统的固有属性，不可破坏：<ul><li>互斥条件：资源不可共享（软件：锁；硬件：所有外设）</li><li>不可剥夺条件：指进程已获得的资源在未使用完之前，不能被剥夺，只能使用完自己释放</li></ul></li><li>破坏其中之一，就可以避免死锁：<ul><li>请求和保持条件：进程先申请一部分资源，再申请另一部分资源。在无法获得新的资源的时候，不放弃已有资源</li><li>循环等待条件：资源分配图里有环路</li></ul></li></ul></li></ol><hr><ol start=2><li>处理死锁的方法<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405380206 width=888 height=339 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405380206_hu_994e2724c4c7d153.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405380206_hu_994e2724c4c7d153.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405380206.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405380206.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405420673 width=886 height=438 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405420673_hu_e74ad799f9dd48cd.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405420673_hu_e74ad799f9dd48cd.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405420673.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405420673.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405428811 width=851 height=432 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405428811_hu_5eebd931e9ba3c54.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405428811_hu_5eebd931e9ba3c54.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405428811.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405428811.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405436756 width=796 height=441 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405436756.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405436756.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405436756.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405436756.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405445613 width=859 height=396 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405445613_hu_318f22033ed88b08.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405445613_hu_318f22033ed88b08.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405445613.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405445613.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405453963 width=737 height=201 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405453963.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405453963.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405453963.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405453963.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405463420 width=827 height=445 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405463420_hu_25dc31f4ca4527b1.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405463420_hu_25dc31f4ca4527b1.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405463420.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405463420.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405473087 width=829 height=452 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405473087_hu_9eb3b6083d67c54c.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405473087_hu_9eb3b6083d67c54c.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405473087.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405473087.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405481016 width=865 height=452 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405481016_hu_d6ce599d64342f74.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405481016_hu_d6ce599d64342f74.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405481016.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405481016.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405492202 width=806 height=446 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405492202_hu_55823da0961e4531.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405492202_hu_55823da0961e4531.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405492202.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405492202.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735405500660 width=806 height=443 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405500660_hu_ca3d94f1c1b4f4c.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405500660_hu_ca3d94f1c1b4f4c.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405500660.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735405500660.png></figure></li></ol><hr><h3 class="relative group">复习重点<div id=复习重点-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%a4%8d%e4%b9%a0%e9%87%8d%e7%82%b9-1 aria-label=锚点>#</a></span></h3><ol><li>为什么要引入进程？为什么要引入线程？从调度性、并发性、拥有的资源以及系统开销等方面，区别和比较进程和线程？</li></ol><hr><ol start=2><li>进程状态迁移图，引起状态迁移的原因和事件？</li></ol><hr><ol start=3><li>进程组成？PCB 的含义？</li></ol><hr><ol start=4><li>进程之间的关系？什么是临界区？如何实现临界区的互斥访问？</li></ol><hr><ol start=5><li>P/V 操作的含义？信号量的含义？如何定义信号量的初值？如何利用 P/V 操作实现多个进程之间的同步和互斥？如利用其实现单缓冲区的读写问题？如何实现生产者消费者等问题？</li></ol><hr><ol start=6><li>高级通信方式中，理解 send()和 receive（）的工作过程。</li></ol><hr><ol start=7><li>有哪些常用调度算法？引起进程调度的事件有那些？多级反馈队列调度算法的分析？</li></ol><hr><ol start=8><li>引起死锁的四个特征是什么？如何针对这是个特征克服死锁？资源分配图的方法判定死锁？</li></ol><hr><h2 class="relative group">内存管理<div id=内存管理 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86 aria-label=锚点>#</a></span></h2><blockquote><p>思考题，考前不看
段式，段页式不考! md</p></blockquote><h3 class="relative group">基本概念<div id=基本概念 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5 aria-label=锚点>#</a></span></h3><ol><li>多级存储器结构<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735377335500 width=829 height=349 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377335500_hu_41e5dbafc7ef1c1b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377335500_hu_41e5dbafc7ef1c1b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377335500.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377335500.png></figure><strong>存储管理终极目标</strong>：统一管理不同层次的存储介质。为系统提供容量近似于磁盘，访问速度近似于 cache 的物理存储器</li></ol><hr><ol start=2><li>存储管理的任务<ul><li><strong>存储资源管理</strong>：空闲资源管理、存储空间分配和释放</li><li><strong>提供地址重定位机制</strong>：将指令和数据的逻辑地址转化为内存单元的物理地址</li><li><strong>提供内存保护机制</strong>：防止现运行进程破坏内核或分配给其它进程的内存单元，以非法方式访问进程图像</li><li><strong>内存扩充</strong>：借助大容量辅存扩充物理内存容量，存放暂时不用的进程图像。为系统提供一个容量比物理内存大许多的可执行存储器，以容纳更多的进程图像。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735378328950 width=805 height=424 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378328950_hu_f5588febb0c3b766.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378328950_hu_f5588febb0c3b766.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378328950.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378328950.png></figure></li></ul></li></ol><hr><h3 class="relative group">存储管理方式<div id=存储管理方式 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%ad%98%e5%82%a8%e7%ae%a1%e7%90%86%e6%96%b9%e5%bc%8f aria-label=锚点>#</a></span></h3><ul><li>为进程图像分配连续物理空间</li><li>所有图像均在内存的进程才能够执行</li><li>移动时搬迁的是整个进程图像。包括内存中的移动和换入、换出操作</li></ul><hr><ol><li>可变分区</li></ol><ul><li>每个分区放一个进程。分区不固定。</li><li>用 <strong>空闲分区表（map 数组）</strong> 登记所有空闲分区的首地址和长度。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735377668749 width=896 height=436 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377668749_hu_9ee5d161ac3b1a9f.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377668749_hu_9ee5d161ac3b1a9f.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377668749.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377668749.png></figure></li></ul><hr><ol start=2><li>地址重定位和内存保护<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735377712649 width=922 height=461 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377712649_hu_f268a8525115935b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377712649_hu_f268a8525115935b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377712649.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377712649.png></figure></li></ol><hr><ol start=3><li>内存扩充<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735377749379 width=843 height=189 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377749379_hu_dd5071c0afec7733.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377749379_hu_dd5071c0afec7733.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377749379.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377749379.png></figure></li></ol><hr><ol start=4><li>优缺点<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735377817381 width=873 height=398 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377817381_hu_85e5123c6deda76b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377817381_hu_85e5123c6deda76b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377817381.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735377817381.png></figure></li></ol><hr><ol start=5><li><p>概念</p><ul><li>逻辑地址：程序中指令 和 数据的地址。编译、链接过程确定的。</li><li>物理地址：指令和数据在物理内存中的地址。操作系统内核决定的。</li><li>虚空间（地址空间），逻辑地址集合。</li><li>线性地址空间：进程可以访问的所有逻辑地址 = 应用程序的虚空间 ∪ 内核的虚空间。</li><li>物理地址空间，物理地址集合。</li><li>重定位（Relocate）：将可执行程序中，指令和数据的逻辑地址转换成物理地址。<ul><li>静态重定位：由软件实施，程序加载时</li><li>动态重定位：动态重定位由 CPU 硬件，每次访存时实施：MMU 将逻辑地址转换成物理地址。</li></ul></li></ul></li></ol><hr><ol start=6><li><p>内存分配方式<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735378366148 width=727 height=262 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378366148.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378366148.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378366148.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378366148.png></figure></p><ul><li><p><strong>连续内存分配方式</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735378411455 width=911 height=430 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378411455_hu_db408bf979faa955.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378411455_hu_db408bf979faa955.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378411455.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378411455.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735378437361 width=912 height=393 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378437361_hu_2f63212d15c0568e.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378437361_hu_2f63212d15c0568e.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378437361.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378437361.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735378469751 width=895 height=412 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378469751_hu_bda3d2fbb0fc45f8.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378469751_hu_bda3d2fbb0fc45f8.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378469751.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378469751.png></figure></p></li><li><p><strong>段式内存管理</strong>
为每个逻辑段独立分配物理内存空间，每个进程一张段表，登记所有逻辑段的 <strong>首地址</strong>，<strong>长度</strong> 和 <strong>保护位</strong>。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735378607206 width=877 height=458 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378607206_hu_17247500f55342fa.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378607206_hu_17247500f55342fa.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378607206.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378607206.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735378765772 width=912 height=428 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378765772_hu_90059cc01cc4e329.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378765772_hu_90059cc01cc4e329.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378765772.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735378765772.png></figure></p><ul><li>段是自然的共享、保护单位<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735379082092 width=911 height=387 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379082092_hu_226e7b9cf172f7c4.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379082092_hu_226e7b9cf172f7c4.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379082092.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379082092.png></figure></li><li>段式内存管理的内存分配：内存分配，<strong>以自然段为单位</strong>，自然段长度可变，内存分配麻烦，存在外部碎片问题，物理内存利用率低。</li></ul></li><li><p><strong>页式存储管理方式</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735379305794 width=921 height=325 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379305794_hu_7ead6e1284cbdf24.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379305794_hu_7ead6e1284cbdf24.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379305794.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379305794.png></figure></p><ul><li><p>虚空间等分为若干个逻辑页面，逻辑页面(2^n)字节</p></li><li><p>实空间（物理内存），按相同尺寸分为若干个页框</p></li><li><p>允许为逻辑页面分配任意空闲的物理页框。</p></li><li><p>每个进程一张页表（Page Table），登记所有逻辑页面的 <strong>物理页框号</strong> 和 <strong>保护位</strong>。</p></li><li><p>每个逻辑页面一个页表项（Page Table Entry，PTE）</p></li><li><p>base 是分配给它的物理页框号</p></li><li><p><code>prot</code> 是保护位：</p><ul><li><code>U/S</code>：1 (U) 表示应用程序的逻辑页，CPU 用户态运行时有权访问；0 (S) 表示内核的逻辑页，CPU 用户态运行时无权访问。</li><li><code>RW/RO</code>：1 (RW) 表示可读、可写；0 (RO) 表示只读。</li><li><code>X</code>：1 表示代码页，可执行；0 表示数据页，不可执行。</li></ul></li><li><p>逻辑地址和页表<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735379756422 width=822 height=378 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379756422_hu_8dbbfd8589e45602.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379756422_hu_8dbbfd8589e45602.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379756422.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379756422.png></figure></p></li><li><p>地址映射和内存保护<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735379868470 width=811 height=426 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379868470_hu_5eddecde6a3356e2.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379868470_hu_5eddecde6a3356e2.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379868470.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735379868470.png></figure></p></li><li><p>页式存储管理的优点</p><ul><li>页式最显著的优点，<strong>提高物理内存的利用率</strong>。每一个物理页框可以用来存放任何进程的任意逻辑页面。不存在 <strong>外部碎片</strong> 问题。但是存在页内碎片问题。</li><li>扩展进程图象极其容易，已有进程不必移动。（<strong>栈从高地址向低地址增长，堆从低地址向高地址增长</strong>）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735380791982 width=894 height=413 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735380791982_hu_3090f7ddd433ef79.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735380791982_hu_3090f7ddd433ef79.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735380791982.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735380791982.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735380856804 width=919 height=433 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735380856804_hu_502d07db280ef813.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735380856804_hu_502d07db280ef813.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735380856804.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735380856804.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381004398 width=852 height=402 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381004398_hu_3718996475621e02.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381004398_hu_3718996475621e02.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381004398.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381004398.png></figure></li><li>以页为单位共享和保护物理内存</li></ul></li><li><p>页式存储管理的缺点</p><ul><li>页表太大，页表项太多，页表占用内存空间太大。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381116971 width=747 height=273 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381116971.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381116971.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381116971.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381116971.png></figure></li><li>页表查找时间太长，页表查找时间太长，页式地址映射，访存耗时加倍，CPU 运算速度减半。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381144639 width=893 height=389 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381144639_hu_7487661ceb50065f.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381144639_hu_7487661ceb50065f.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381144639.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381144639.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381237716 width=892 height=383 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381237716_hu_1b733bf718ff00cc.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381237716_hu_1b733bf718ff00cc.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381237716.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381237716.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381385053 width=916 height=422 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381385053_hu_e61b85ff769dd818.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381385053_hu_e61b85ff769dd818.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381385053.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381385053.png></figure></li></ul></li></ul></li></ul></li></ol><hr><ol start=7><li><p>CPU 的 Cache<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381436538 width=890 height=329 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381436538_hu_839f96ed5066700.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381436538_hu_839f96ed5066700.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381436538.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381436538.png></figure><strong>指令缓存和数据缓存</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381501579 width=719 height=430 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381501579.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381501579.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381501579.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381501579.png></figure></p><ul><li><p>命中：</p><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381509315 width=895 height=442 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381509315_hu_36b63ac093ccaa35.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381509315_hu_36b63ac093ccaa35.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381509315.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381509315.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381565010 width=892 height=432 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381565010_hu_499487fff8d6da2a.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381565010_hu_499487fff8d6da2a.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381565010.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381565010.png></figure></p></li><li><p>不命中：<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381586846 width=887 height=439 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381586846_hu_4de8c4546a8eb8b4.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381586846_hu_4de8c4546a8eb8b4.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381586846.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381586846.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381647616 width=890 height=426 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381647616_hu_399890c78c06a5b5.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381647616_hu_399890c78c06a5b5.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381647616.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381647616.png></figure></p><p><strong>物理地址访存耗时</strong>：<code>指令/数据缓存访问时间 + 缓存不命中的概率 * 主存访问时间</code><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381786944 width=655 height=426 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381786944.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381786944.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381786944.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381786944.png></figure></p></li></ul><p><strong>TLB（装 PTE 的缓存）</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735381851574 width=920 height=393 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381851574_hu_659905c85013d123.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381851574_hu_659905c85013d123.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381851574.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735381851574.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735382084048 width=888 height=426 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382084048_hu_8097bf751ee1f677.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382084048_hu_8097bf751ee1f677.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382084048.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382084048.png></figure><strong>EAT（Effective Access Time，内存有效访问时间）</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735382092170 width=894 height=422 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382092170_hu_24deca1cbdfa2310.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382092170_hu_24deca1cbdfa2310.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382092170.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382092170.png></figure></p></li></ol><hr><ol start=8><li>空闲分区管理<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735382267249 width=927 height=389 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382267249_hu_d5fb4190193404da.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382267249_hu_d5fb4190193404da.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382267249.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382267249.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735382291020 width=747 height=352 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382291020.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382291020.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382291020.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382291020.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735382308637 width=809 height=366 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382308637_hu_16fd4774bfed86b3.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382308637_hu_16fd4774bfed86b3.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382308637.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735382308637.png></figure></li></ol><hr><h3 class="relative group">虚拟存储器<div id=虚拟存储器 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e8%99%9a%e6%8b%9f%e5%ad%98%e5%82%a8%e5%99%a8 aria-label=锚点>#</a></span></h3><ol><li>程序运行的局部性原理：时间局部性和空间局部性</li></ol><hr><ol start=2><li>虚拟存储器改善性能的思路</li></ol><ul><li>传统存储管理方式，一次性为进程图像分配所需的所有内存</li><li>仅为当前需要访问的代码和数据分配内存。现在主流的方法：在基本的分页机制的基础上，加上 <strong>调页机制</strong> 和 <strong>页面置换机制</strong><ul><li>调页机制：为即将访问的页面分配存储空间、并且进行初始化。<ul><li>请求调页：内存分配（调页操作），延迟至页面访问时刻。一次调入一页。</li><li>预调页： 一次调入多个页面。当前需要的页面 + 虚空间中附近的多个页面。</li></ul></li><li>页面置换机制：淘汰暂时不用的页面。将其换至磁盘，释放内存。</li></ul></li><li>基于此技术打造的虚拟存储器，时间 & 空间局部性变现良好的程序，执行速度不会比运行在物理内存慢许多。</li></ul><hr><ol start=3><li><p>虚拟内存器：虚拟存储器用 <strong>硬盘中的 swap 分区（或者 swap 文件）</strong> 作为主存的辅助存储器，存放所有进程的图像；主存中只存放 CPU 最近需要使用的逻辑页面。</p><ul><li>有了虚拟存储器，只需要装入少量逻辑页面进程就可以运行，访问到其它逻辑页面时，MMU 会抛出异常，缺页异常处理程序调入所缺页面。</li><li>虚拟存储器的优点：<ul><li>启动前不必装入全部进程图像，应用程序装载（exec）速度快</li><li>程序员编程不必受物理内存的限制，计算机可以运行虚空间大于内存总容量的应用程序</li><li>最后，除非内存抖动，系统不再需要执行 swap in 和 swap out 操作，系统性能提升。</li></ul></li></ul></li></ol><hr><ol start=4><li><p>请求调页</p><p>任何应用程序，<strong>只需为初始栈分配主存页框</strong>，装入 main 函数栈帧后便可以开始运行。其余进程图像，一次一页，访问时，缺页中断处理程序负责调入。</p><p>请求调页是指如果 CPU 访问的数据或指令不在主存，引发缺页异常，异常处理程序调入所缺逻辑页面。</p><p><strong>缺页（Page Fault）</strong> CPU 所访问的信息内存中不存在。以 i386 芯片为例，present bit 是 0。缺页异常处理过程：</p><ul><li>MMU 硬件<ul><li>(1)当前指令执行时操作数不在内存</li><li>(2)取指时下条指令不在内存，抛出缺页异常。</li></ul></li><li>随后，CPU 中断处理元件<ul><li>(1)压栈引发异常的当前指令的地址.</li><li>(2)<code>cr2</code> 记录引发缺页的那个逻辑地址。</li></ul></li><li>操作系统介入：缺页异常处理程序<ul><li>(1)找 1 个空闲的 <strong>物理页框</strong></li><li>(2)修改页表，目标逻辑页对应的 <code>PTE</code></li><li>(3)初始化物理页框。从磁盘读入包含 CPU 想要访问的数据或指令的整张逻辑页面（1 张页面，4096 字节，要读 8 个连续磁盘扇区）。</li></ul></li><li>异常返回，进程重新执行引发异常的指令。所缺数据在内存，不会引发缺页异常，程序得以继续运行。</li></ul><p><strong>页面置换</strong></p><ul><li>缺页时，异常处理程序会为现运行进程分配一个可用的主存页框。如果内存没了，就要 <strong>覆盖一个逻辑页面</strong>，用分配给它的物理页框装所缺逻辑页。这个操作就是页面置换。</li><li><strong>页面置换方式</strong><ul><li><strong>固定分配局部置换</strong><ul><li>为每个进程分配固定数目的物理页框，如果缺页只能覆盖自己的逻辑页面</li><li>典型算法：<code>FIFO \ LRU \ CLOCK</code></li></ul></li><li><strong>可变分配局部置换</strong><ul><li>为每个进程分配一定数目的物理页框，如果缺页，仍然只能覆盖自己的逻辑页面</li><li><strong>跟踪进程的执行情况</strong><ul><li>频繁缺页，为进程追加物理页框</li><li>缺页率长期维持较低水平，可以收回部分页框</li></ul></li></ul></li><li><strong>可变分配全局置换</strong><ul><li>为每个进程分配一定数目的物理块（物理页框）</li><li>系统维护一个空闲物理块队列</li><li>当某进程发生缺页时，由系统从 <strong>空闲物理块队列</strong> 中取出一个分配给该进程</li><li><strong>空闲队列分配完时</strong>，OS 才会覆盖内存中的逻辑页面</li><li>被覆盖的可能是其他进程的逻辑页面，所以叫 <strong>全局置换</strong></li></ul></li></ul></li></ul></li></ol><hr><ol start=5><li>请求调页系统使用的页表项（PTE）及请求调页操作<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735387541412 width=868 height=417 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387541412_hu_b0fd33bb63bfca35.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387541412_hu_b0fd33bb63bfca35.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387541412.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387541412.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735387754004 width=813 height=471 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387754004_hu_e9805782cfadf5d.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387754004_hu_e9805782cfadf5d.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387754004.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387754004.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735387858756 width=896 height=430 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387858756_hu_ca5ed744e32fcf7a.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387858756_hu_ca5ed744e32fcf7a.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387858756.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387858756.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735387868325 width=907 height=436 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387868325_hu_352d89ae7ed98e3b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387868325_hu_352d89ae7ed98e3b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387868325.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735387868325.png></figure><strong>例题</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735388014908 width=934 height=468 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388014908_hu_8bd6427e42cd774b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388014908_hu_8bd6427e42cd774b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388014908.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388014908.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735388041214 width=879 height=408 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388041214_hu_82d50b15793f4b19.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388041214_hu_82d50b15793f4b19.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388041214.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388041214.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735388047831 width=885 height=442 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388047831_hu_764e32d1baaebd02.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388047831_hu_764e32d1baaebd02.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388047831.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388047831.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735388056842 width=886 height=439 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388056842_hu_96f5a0fbe8987bf1.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388056842_hu_96f5a0fbe8987bf1.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388056842.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388056842.png></figure></li></ol><hr><ol start=6><li><p>页面置换算法（使用固定分配局部置换）
缺页时，若内存已无空闲空间，淘汰一页。用新逻辑页面覆盖被淘汰页面占用的物理页框。若被淘汰页面脏（修改过），写回磁盘。页面置换算法决定淘汰哪一页。<strong>优化目标：降低缺页率</strong>。</p><ul><li>OPT 未来访问时刻最远的（最优）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735388559823 width=852 height=415 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388559823_hu_315df5cee3328ce5.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388559823_hu_315df5cee3328ce5.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388559823.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388559823.png></figure></li><li>FIFO 最先进入内存的<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735388632033 width=894 height=398 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388632033_hu_21018809b3ef5064.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388632033_hu_21018809b3ef5064.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388632033.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388632033.png></figure></li><li>LRU 最近最久未访问的<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735388852388 width=921 height=414 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388852388_hu_220f3de4542fea2a.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388852388_hu_220f3de4542fea2a.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388852388.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388852388.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735388919003 width=744 height=436 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388919003.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388919003.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388919003.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735388919003.png></figure></li><li>CLOCK（NRU，Not Recently Used）淘汰最近没用过的（不一定是最久）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735389051226 width=931 height=323 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389051226_hu_fe9cb4a78978b245.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389051226_hu_fe9cb4a78978b245.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389051226.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389051226.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735389824138 width=830 height=286 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389824138_hu_f9c5b588467eb974.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389824138_hu_f9c5b588467eb974.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389824138.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389824138.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735389831605 width=488 height=429 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389831605.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389831605.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389831605.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389831605.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735389981272 width=719 height=352 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389981272.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389981272.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389981272.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735389981272.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735390008504 width=863 height=326 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390008504_hu_387832f2b2dc72c.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390008504_hu_387832f2b2dc72c.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390008504.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390008504.png></figure></li><li>随机算法</li></ul></li></ol><hr><ol start=7><li>请求调页虚拟存储器相关的理论</li></ol><ul><li><strong>工作集和驻留集</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735390070581 width=772 height=364 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390070581.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390070581.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390070581.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390070581.png></figure></li><li><strong>抖动</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735390203036 width=785 height=384 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390203036.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390203036.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390203036.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735390203036.png></figure></li></ul><hr><h3 class="relative group">复习重点<div id=复习重点-2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%a4%8d%e4%b9%a0%e9%87%8d%e7%82%b9-2 aria-label=锚点>#</a></span></h3><ol><li>程序装入内存有几种方式？什么是可重定位的装入技术？</li></ol><hr><ol start=2><li>在动态分区分配中，有那些分区分配算法？各个是如何实现的？</li></ol><hr><ol start=3><li>什么是虚拟存储器？其特征是什么？虚拟存储器容量是如何确定的？</li></ol><hr><ol start=4><li>请求分页技术中，图示 windows 下的两级分页机制？</li></ol><hr><ol start=5><li>请求分页机制中，页面置换算法有那些，具体实施页面置换过程？</li></ol><hr><ol start=6><li>在交换技术中，进程置换策略是什么？</li></ol><hr><ol start=7><li>什么是快表？其中内容是什么样子的？什么是页表？其结构是如何？</li></ol><hr><h2 class="relative group">文件系统<div id=文件系统 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f aria-label=锚点>#</a></span></h2><blockquote><p>预读的代码考试不考。知道 read 系统调用什么时候用它就行
到这个程度《文件系统 例题和习题 2 完整的文件读写过程》</p></blockquote><h3 class="relative group">Unix 文件系统<div id=unix-文件系统 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#unix-%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f aria-label=锚点>#</a></span></h3><ol><li>文件系统存放很多文件，文件是 <strong>可重复访问的字节序列</strong>，支持 <strong>随机访问</strong>、所有字节可 <strong>重复读写</strong>。</li></ol><hr><ol start=2><li><p>用户存放的文件，是文件系统的用户数据</p><ul><li>可执行文件供进程管理系统使用</li><li>普通数据文件供应用程序使用</li></ul></li></ol><hr><ol start=3><li>用来管理文件的数据结构，是文件系统的 <strong>元数据（metadata）</strong><ul><li>每个文件一个文件控制块，登记文件访问权限、文件数据块存放的位置</li><li>读写文件，需要使用文件控制块</li><li>文件树，挂所有文件，目录搜索就是在文件树上查找文件</li><li>用户数据和元数据存放在同一张磁盘</li></ul></li></ol><hr><ol start=4><li>文件基础概念<ul><li>文件按磁盘数据块大小切块，<strong>离散存放在磁盘上，每一块是一个逻辑块</strong></li><li>为文件分配的磁盘存储空间，是 <strong>整数个</strong> 磁盘数据块</li><li>文件系统使用 <strong>离散存储管理方式</strong>。相邻的文件逻辑块在磁盘上 <strong>不必连续存放</strong>。但尽量连续存放一定能提升文件顺序读写效率。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735371637886 width=810 height=82 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735371637886_hu_9a02799724d6cfed.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735371637886_hu_9a02799724d6cfed.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735371637886.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735371637886.png></figure></li></ul></li></ol><hr><ol start=5><li><p>文件控制块（FCB，File Control Block）</p><p>每个文件有一个文件控制块 FCB，包括如下信息：</p><ul><li>地址映射表，用来计算分配给逻辑块 <code>bn</code> 的物理块号 <code>dn</code></li><li><code>dn = f(bn) /* bn = offset/512; offset是数据在文件中的偏移量 */</code></li><li>数据存放在物理块 dn，块内偏移量是 <code>offset % 512</code></li><li>文件主 <code>uid</code>，创建该文件的进程的 <code>uid</code></li><li>文件访问权限，登记各类用户对该文件的读、写、执行权限</li><li>Unix 是 <code>RWXRWXRWX</code>，标识 <strong>文件主</strong>，<strong>文件所在的用户组</strong> 和 <strong>nobody</strong> 对文件的读、写、执行 权限。</li><li>Windows 是 ACL（Access Control List）</li><li>进程 uid 和 gid 标识使用文件的用户和用户组</li><li>创建时刻，最后一次访问时刻，最后一次修改时刻。</li></ul><p><strong>FCB 的使用：</strong></p><ul><li>创建文件时，进程执行系统调用 <code>create("文件名", mode)</code> 创建 FCB。<code>mode</code> 是文件的访
问权限 <code>rwxrwxrwx</code>。<ul><li>新建 FCB，填入文件名，<code>uid=进程 uid</code>，<code>访问权限=mode</code>。<code>文件尺寸=0</code>，<code>创建时刻=time</code>。</li></ul></li><li>访问已有文件，进程需要使用 FCB。<ul><li>使用文件前，执行 open 系统调用打开文件。<ul><li><code>open ("文件名", mode)</code> 。mode 是进程希望对文件执行的操作：读、写 还是 既读又写。</li><li>需要将 FCB 读入内存，使用访问权限字段，判断进程（p_uid 用户）有没有文件的访问权限。</li></ul></li><li>读写文件时，进程执行 <code>read/write</code> 系统调用。<ul><li>需要使用 FCB 中的地址映射表确定需要读写的磁盘数据块</li><li>执行 bread/bwrite/breada……合适的函数，进行字符块读写</li></ul></li></ul></li><li>文件访问结束，执行 close 系统调用关闭文件。内存中的 FCB，如果发生变化，写回磁盘。 - 写文件会导致文件长度和地址映射表发生变化<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735372166855 width=700 height=386 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372166855.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372166855.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372166855.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372166855.png></figure></li></ul></li></ol><hr><ol start=6><li><p>文件树，目录项 和 目录文件</p><ol><li>文件树<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735372252794 width=738 height=329 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372252794.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372252794.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372252794.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372252794.png></figure></li><li>绝对路径、相对路径<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735372462257 width=914 height=305 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372462257_hu_cd19c61d11f24d1b.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372462257_hu_cd19c61d11f24d1b.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372462257.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372462257.png></figure></li></ol></li></ol><hr><ol start=7><li><p>DiskInode
<code>DiskInode</code> 是 <code>Unix</code> 的文件控制块。<code>DiskInode</code> 号是文件 ID，文件的内部标识，每个文件，磁盘上有一个 <code>DiskInode</code>。</p><div class=highlight-wrapper><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>class</span> <span class=nc>DiskInode</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>d_mode</span><span class=p>;</span>  <span class=c1>// 文件模式
</span></span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d_nlink</span><span class=p>;</span>          <span class=c1>// 硬链接数
</span></span></span><span class=line><span class=cl>    <span class=kt>short</span> <span class=n>d_uid</span><span class=p>;</span>          <span class=c1>// 文件主的 uid
</span></span></span><span class=line><span class=cl>    <span class=kt>short</span> <span class=n>d_gid</span><span class=p>;</span>          <span class=c1>// 文件所在的组
</span></span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d_size</span><span class=p>;</span>           <span class=c1>// 文件尺寸，字节数
</span></span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d_addr</span><span class=p>[</span><span class=mi>10</span><span class=p>];</span>       <span class=c1>// 混合索引表根节点
</span></span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d_atime</span><span class=p>;</span>          <span class=c1>// 最后访问时刻
</span></span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>d_mtime</span><span class=p>;</span>          <span class=c1>// 最后修改时刻
</span></span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></div></div><p><code>d_mode</code>，<code>DiskInode</code> 的使用状态、文件类型 和 访问权限<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735372781403 width=838 height=252 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372781403_hu_d4618ba6bb45d568.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372781403_hu_d4618ba6bb45d568.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372781403.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372781403.png></figure><code>d_addr</code>，用来进行地址映射</p></li></ol><hr><ol start=8><li>文件卷<ul><li>每个 <strong>文件系统</strong> 有自己的 <strong>文件卷</strong>，存有运行所需的全部内核数据结构和它所管理的数据文件。</li><li>卷格式取决于具体的文件系统。Unix 文件卷 和 Windows 文件卷格式完全不同。<ul><li><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735372989350 width=694 height=104 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372989350.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372989350.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372989350.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735372989350.png></figure></li><li><strong>超级块</strong>，存放文件卷 info 和文件系统的使用状态</li><li><strong>inode 区</strong>，存放 DiskInode（64 字节）。<ul><li>空闲标识，<code>d_mode</code> 中 <code>IALLOC</code> 为 0，不在内存打开 inode 池中</li><li>DiskInode 编号由存储位置决定，<code>n# DiskInode</code>，扇区号 <code>n/8+2</code>，扇区内偏移量 <code>n%8</code><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735373254877 width=542 height=280 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373254877.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373254877.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373254877.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373254877.png></figure></li></ul></li><li><strong>数据区</strong>，存放普通数据文件和目录文件（数据块、索引块）。数据区的资源是物理块，Unix V6 中为 1 个扇区、512 字节没有空闲标识</li></ul></li></ul></li></ol><hr><ol start=9><li><p>Unix V6++系统中文件</p><ol><li><p>磁盘上的普通数据文件<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735373390819 width=836 height=431 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373390819_hu_66b49a84ea2a7c86.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373390819_hu_66b49a84ea2a7c86.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373390819.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373390819.png></figure></p><ul><li>混合索引树<ul><li><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735373409365 width=853 height=471 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373409365_hu_99dff2a0464541d3.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373409365_hu_99dff2a0464541d3.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373409365.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373409365.png></figure></li><li>DiskInode 中的 d_addr 数组是混合索引树的根节点。</li><li>d_addr [0] ~ d_addr [5]，可以登记 6 个物理块号，存放文件的 0#~5#逻辑块。</li><li>d_addr [6]，第 1 个索引块，可以登记 128 个物理块号。</li><li>d_addr [7]，第 2 个索引盘块，可以登记 128 个物理块号。</li><li>d_addr [8] 和 d_addr [9] 是 2 次索引块。每个 2 次索引盘块可以挂 128 个一次索引盘块，用来支持很大的文件。<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735373798299 width=941 height=408 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373798299_hu_9cfd4848ad10d3ed.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373798299_hu_9cfd4848ad10d3ed.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373798299.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373798299.png></figure></li></ul></li></ul></li><li><p>磁盘上的目录文件<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735373827425 width=853 height=438 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373827425_hu_544c7100be3105bc.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373827425_hu_544c7100be3105bc.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373827425.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373827425.png></figure>John 的目录项，存放在目录文件 home<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735373932991 width=688 height=366 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373932991.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373932991.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373932991.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735373932991.png></figure></p></li><li><p>特殊文件（外设硬件）</p></li></ol></li></ol><hr><ol start=10><li>磁盘空闲资源管理<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735374013016 width=845 height=358 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374013016_hu_b06ca828374256d8.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374013016_hu_b06ca828374256d8.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374013016.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374013016.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735374044713 width=915 height=400 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374044713_hu_547c20d239e59d66.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374044713_hu_547c20d239e59d66.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374044713.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374044713.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735374167319 width=775 height=280 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374167319.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374167319.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374167319.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374167319.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735374174077 width=713 height=388 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374174077.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374174077.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374174077.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374174077.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735374182892 width=901 height=441 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374182892_hu_53befcbe8bc5f6c0.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374182892_hu_53befcbe8bc5f6c0.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374182892.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374182892.png></figure></li></ol><hr><ol start=11><li>主硬盘<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735374770476 width=902 height=411 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374770476_hu_6d0fa76fe0fd24c7.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374770476_hu_6d0fa76fe0fd24c7.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374770476.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374770476.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735374804490 width=898 height=386 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374804490_hu_d53099eea1935ea.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374804490_hu_d53099eea1935ea.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374804490.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735374804490.png></figure></li></ol><hr><h3 class="relative group">文件系统的使用<div id=文件系统的使用 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e7%9a%84%e4%bd%bf%e7%94%a8 aria-label=锚点>#</a></span></h3><ol><li>文件系统的使用过程<ul><li>使用前装载 mount<ul><li><strong>将超级块读入内存</strong>。分配、释放存储资源需要使用空闲盘块号栈和空闲 Inode 栈。</li><li><strong>将根目录 Inode 读入内存</strong>。搜索文件时要用文件树。</li></ul></li><li>使用阶段<ul><li>搜索、维护文件树<ul><li>（1）打开已有文件、目录</li><li>（2）新建文件/子目录时，增加节点和边</li><li>（3）删除文件/子目录时，去除节点和边。</li></ul></li><li>访问普通数据文件。read、write 系统调用。<code>写文件会更新 DiskInode</code>。</li></ul></li><li>使用完毕卸载 unmount<ul><li>超级块 和 所有脏数据写回磁盘</li></ul></li></ul></li><li>文件系统的元数据 metadata<ul><li>文件系统的元数据 metadata 是文件系统持久化在磁盘上的内核数据结构</li><li>Unix V6++：超级块、DiskInode 和 DirectoryEntry</li><li>磁盘上的数据结构，使用前，复制进内存。用完，更新后的数据结构写回磁盘。</li></ul></li></ol><hr><ol start=3><li>支持文件系统运行的数据结构（系统层面）<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375186936 width=889 height=328 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375186936_hu_b9d6a386a49e7c21.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375186936_hu_b9d6a386a49e7c21.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375186936.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375186936.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375301097 width=930 height=401 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375301097_hu_98c08355bc53d20.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375301097_hu_98c08355bc53d20.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375301097.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375301097.png></figure><strong>文件系统会话</strong><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375338945 width=880 height=276 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375338945_hu_e557a4c3f78fdc63.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375338945_hu_e557a4c3f78fdc63.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375338945.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375338945.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375374169 width=854 height=416 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375374169_hu_6d7cefcefd55233.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375374169_hu_6d7cefcefd55233.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375374169.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375374169.png></figure></li></ol><hr><ol start=3><li>支持文件系统运行的数据结构（进程层面）<ul><li>外部标识：文件路径名；</li><li>内部标识：文件描述符，打开文件表的下标 <code>fd</code><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375428530 width=900 height=327 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375428530_hu_7f5a8a1594b77035.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375428530_hu_7f5a8a1594b77035.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375428530.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375428530.png></figure></li></ul></li></ol><hr><ol start=4><li>进程访问数据文件，需要使用打开文件结构<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375523220 width=693 height=340 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375523220.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375523220.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375523220.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375523220.png></figure><ol><li>read 系统调用<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375557658 width=862 height=365 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375557658_hu_b28bda924a908f8c.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375557658_hu_b28bda924a908f8c.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375557658.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375557658.png></figure></li><li>write 系统调用<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375640464 width=825 height=356 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375640464_hu_4b84bd1e4af7d9bf.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375640464_hu_4b84bd1e4af7d9bf.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375640464.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375640464.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375655705 width=920 height=465 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375655705_hu_4ad7bb8dc22a22e9.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375655705_hu_4ad7bb8dc22a22e9.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375655705.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375655705.png></figure></li><li>seek 系统调用<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375805576 width=848 height=404 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375805576_hu_11d80a05d46d0380.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375805576_hu_11d80a05d46d0380.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375805576.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375805576.png></figure></li></ol></li></ol><hr><ol start=5><li>文件树使用和维护<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735375864414 width=726 height=322 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375864414.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375864414.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375864414.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735375864414.png></figure></li></ol><hr><ol start=6><li>打开文件结构的使用和维护<ol><li><code>fd=open()</code> 建立打开文件结构</li><li><code>close(fd)</code> 拆除打开文件结构，释放资源<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735376333695 width=771 height=341 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376333695.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376333695.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376333695.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376333695.png></figure></li><li>fork 创建的子进程集成父进程打开的文件<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735376365934 width=644 height=367 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376365934.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376365934.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376365934.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376365934.png></figure><ul><li>进程的标准输入、输出文件
这三个文件无需打开。它们，用户登录（login）时打开，fork 时继承自 shell 进程（V6++没有登录过程，系统初始化时 main0 打开这 3 个文件）所以进程打开文件表中 <code>0,1,2</code> 项要空出来，从 <code>3</code> 开始分配 File 结构。<ul><li>0，STDIN, 标准输入</li><li>1，STDOUT，标准输出</li><li>2，STDERR，标准错误输出(Unix V6++没有)</li></ul></li><li>标准输入输出文件的使用<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735376551117 width=885 height=377 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376551117_hu_8c4689f2be1da23e.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376551117_hu_8c4689f2be1da23e.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376551117.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376551117.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735376672935 width=675 height=428 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376672935.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376672935.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376672935.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376672935.png></figure><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735376705529 width=903 height=463 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376705529_hu_723a170657d3eef4.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376705529_hu_723a170657d3eef4.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376705529.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376705529.png></figure></li></ul></li></ol></li></ol><hr><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=auto alt=1735376798890 width=866 height=443 src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376798890_hu_8da12885d63a326d.png srcset="/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376798890_hu_8da12885d63a326d.png 800w, /docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376798890.png 1280w" sizes="(min-width: 768px) 50vw, 65vw" data-zoom-src=/docs/os/image/2024%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9C%9F%E6%9C%AB/1735376798890.png></figure></p><hr><h3 class="relative group">复习重点<div id=复习重点-3 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#%e5%a4%8d%e4%b9%a0%e9%87%8d%e7%82%b9-3 aria-label=锚点>#</a></span></h3><ol><li>什么是文件？什么是文件系统？文件系统设计目标是什么？</li></ol><hr><ol start=2><li>什么是文件的逻辑结构、物理结构？文件物理结构有哪些？分别如何实现？有什么特点？</li></ol><hr><ol start=3><li>UNIX 系统采用的综合索引方式是如何实现的？有何优点？</li></ol><hr><ol start=4><li>磁盘空闲空间的管理方法？图示成组链接法？并说明其优点。</li></ol><hr><ol start=5><li>什么是目录文件的组成？采用目标文件的目的？目录的改进方法及其改进性能比较？常用的目录结构？</li></ol><hr><ol start=6><li>RAID 的概念？关键技术是什么？</li></ol><hr><ol start=7><li>文件操作中, open 函数实现过程及其完成的内容？</li></ol><hr><ol start=8><li>影响磁盘访问的因素有那些？列举几种磁盘调度算法？</li></ol><hr><p>The End.</p></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://api.qrserver.com/v1/create-qr-code/?data=https://flesymeb.github.io/docs/os/&amp;size=400x400&amp;color=000000&amp;bgcolor=FFFFFF&amp;margin=20&amp;qzone=5&amp;format=png" title aria-label><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 64C0 46.3 14.3 32 32 32c229.8.0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7.0 64zM128 416c0 35.3-28.7 64-64 64S0 451.3.0 416s28.7-64 64-64 64 28.7 64 64zM32 160c159.1.0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7.0-32-14.3-32-32s14.3-32 32-32z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://flesymeb.github.io/docs/os/&amp;text=2024%20%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e6%9c%9f%e6%9c%ab%e5%a4%8d%e4%b9%a0" title="分享到 Twitter" aria-label="分享到 Twitter"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://flesymeb.github.io/docs/os/&amp;resubmit=true&amp;title=2024%20%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e6%9c%9f%e6%9c%ab%e5%a4%8d%e4%b9%a0" title="通过 Telegram 分享" aria-label="通过 Telegram 分享"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://flesymeb.github.io/docs/os/&amp;subject=2024%20%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e6%9c%9f%e6%9c%ab%e5%a4%8d%e4%b9%a0" title=通过电子邮件发送 aria-label=通过电子邮件发送><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></section><h2 class="mt-8 text-2xl font-extrabold mb-10">相关文章</h2><section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3"><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/docs/systemstructure/featured_hu_d1514f2262cd85bb.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/docs/systemstructure/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>2024 计算机系统结构复习</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-12-25T14:23:00+08:00>2024-12-25</time><span class="px-2 text-primary-500">&#183;</span><span>9859 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>20 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_docs/SystemStructure/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">计算机系统结构
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E5%A4%8D%E4%B9%A0/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">复习</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/docs/softwareengineering/featured_hu_7bf5a01ee0964c84.jpeg role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/docs/softwareengineering/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>2024 软件工程复习</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-12-21T01:53:50+08:00>2024-12-21</time><span class="px-2 text-primary-500">&#183;</span><span>15359 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>31 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_docs/SoftwareEngineering/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">软件工程
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E5%A4%8D%E4%B9%A0/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">复习</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/posts/daily/2024-12-04/featured_hu_79d9b298cf0b3794.jpg role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/daily/2024-12-04/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>2024 12 04</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-12-04T00:00:00+08:00>2024-12-04</time><span class="px-2 text-primary-500">&#183;</span><span>471 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>1 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/daily/2024-12-04/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/%E6%97%A5%E5%B8%B8/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">日常
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E5%A4%AA%E9%98%B3%E7%85%A7%E5%B8%B8%E5%8D%87%E8%B5%B7/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">太阳照常升起
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E6%AD%A5%E5%B1%A5%E4%B8%8D%E5%81%9C/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">步履不停</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/posts/daily/2024-11-07/featured_hu_c5cd29c1da4f805c.jpg role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/posts/daily/2024-11-07/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>2024 11 07</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-11-17T01:42:54+08:00>2024-11-17</time><span class="px-2 text-primary-500">&#183;</span><span>237 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>1 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_posts/daily/2024-11-07/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/%E6%97%A5%E5%B8%B8/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">日常
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E5%A4%AA%E9%98%B3%E7%85%A7%E5%B8%B8%E5%8D%87%E8%B5%B7/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">太阳照常升起
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E6%AD%A5%E5%B1%A5%E4%B8%8D%E5%81%9C/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">步履不停</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/docs/tj-dorm-wifi-auto-login/featured_hu_f40426e57fd7c911.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/docs/tj-dorm-wifi-auto-login/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Tongji-DORM-WIFI自动登录</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-10-30T01:52:50+08:00>2024-10-30</time><span class="px-2 text-primary-500">&#183;</span><span>1941 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>4 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_docs/TJ-DORM-WIFI-AUTO-LOGIN/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/%E5%B7%A5%E5%85%B7/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">工具
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E7%BD%91%E7%BB%9C/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">网络
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E5%90%8C%E6%B5%8E/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">同济</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article><article class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600"><div class="flex-none relative overflow-hidden thumbnail_card_related"><img src=/docs/follow_the_rss_reader/featured_hu_36c16e402941fd01.png role=presentation loading=lazy decoding=async fetchpriority=low class="not-prose absolute inset-0 w-full h-full object-cover"></div><div class=p-4><header><a href=/docs/follow_the_rss_reader/ class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2"><h2>Follow,下一代的聚合信息浏览器</h2></a></header><div class="text-sm text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-10-26T14:57:25+08:00>2024-10-26</time><span class="px-2 text-primary-500">&#183;</span><span>1406 字</span><span class="px-2 text-primary-500">&#183;</span><span title=预计阅读>3 分钟</span><span class="px-2 text-primary-500">&#183;</span><span>
<span id=views_docs/Follow_the_Rss_Reader/index.md class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" title=views>loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 576 512"><path fill="currentColor" d="M288 32c-80.8.0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7.0 24.6C17.3 304 48.6 356 95.4 399.4 142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1 3.3-7.9 3.3-16.7.0-24.6-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144 64.5-144 144-144 144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64-11.5.0-22.3-3-31.6-8.4-.2 2.8-.4 5.5-.4 8.4.0 53 43 96 96 96s96-43 96-96-43-96-96-96c-2.8.0-5.6.1-8.4.4 5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span></span></div><div class="flex flex-row flex-wrap items-center"></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/%E8%BD%AF%E4%BB%B6%E6%8E%A8%E8%8D%90/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">软件推荐
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/%E9%98%85%E8%AF%BB/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">阅读</span></span></a></div></div></div><div class="px-6 pt-4 pb-2"></div></article></section></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_docs/OS/index.md data-oid-likes=likes_docs/OS/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/docs/systemstructure/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;2024 计算机系统结构复习
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2024-12-25T14:23:00+08:00>2024-12-25</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/docs/study/20250219_qwen_fine_tune/><span class=leading-6>使用 LLaMAFactory 实现大模型微调&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2025-02-19T19:14:32+08:00>2025-02-19</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label=返回顶部 title=返回顶部>&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/tags/ title=Tags>标签</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/authors/hyoungyan/ title="Hyoung Yan">作者</a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy; 2026 Hyoung Yan</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script><a rel=me href=https://flesymeb.github.io></a></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://flesymeb.github.io/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=搜索 tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="关闭 (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>